<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로드의 전술서</title>
    <link href="/sources/img/로전아이콘.svg" rel="shortcut icon" type="image/x-icon">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/index.css" rel="stylesheet">
    <link href="/css/form_card.css" rel="stylesheet">

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8925406073494167"
     crossorigin="anonymous"></script>
</head>
<body>
    
    <%- include('nav_and_banner.ejs', {page: 'main', nickname: data.nickname, notice:data.banner_notice }) %> 

    <div class="move-btn-container d-flex justify-content-between">
        <div class="move-btn-shadow">
            <a href="/formmake" class="color-black">
            <div class="move-btn ">
                <h4>기사단 <br> 편성하기</h4>
                <p class="color-gray">편성 저장 및 공유</p>
                <!-- <img src="../sources/img/sword-fill-svgrepo-com.svg" class="move-btn-icon"> -->
                <div class="formmake-btn-icon"></div>
            </div>
            </a>
        </div>
        <div class="move-btn-right">
            <div class="move-btn-shadow notice-btn">
                <a href="/info" class="color-black">
                <div class=" move-btn ">
                    <h4>이용 안내</h4>
                    <p class="color-gray">로드의 전술서란?</p>
                    
                    <div class="notice-btn-icon"></div>
                </div>
                </a>
            </div>

            <div class="move-btn-shadow" >
                <a href="/mypage" class="color-black">
                <div class="move-btn ">
                    <h4>마이페이지</h4>
                    <p class="color-gray">보유 영웅 설정하러가기</p>
                    <div class="mypage-btn-icon"></div>

                </div>
                </a>
            </div>
        </div>
    </div>




    <!-- 게시판 미리보기 ============================================== -->

    <div class="forum-preview-container">
        <div class="move-btn-shadow">
            <div class="forum-preview-tag color-white">
                <h5>오늘의 조합 공유 게시판</h5>
            </div>
        </div>
        <div class="d-flex justify-content-end">
            <a href="/forum" class="forum-link color-black">조합 공유 게시판으로 <i class="fa-solid fa-caret-right"></i></a>
        </div>
        <div class="forum-preview bg-basicdark d-flex justify-content-around">
            <div class="forum-preview-line">
                <h5 class="color-yellow"><i class="fa-solid fa-crown"></i> 베스트 조합 공유</h5>
                 
                <% for(let i=0; i<data.best_form_list.length; i++){ %>
                    <!-- 공유 게시글 하나 -->
                        <%- include('./components/form_preview.ejs', {i: i, data : {
                            from: data.from,
                            saved_forms : data.saved_forms,
                            form_list : data.best_form_list,
                            members : data.best_members,
                        }}) %> 
                    <!-- 공유 게시글 하나 끝 -->
                <%  }%>
                
            </div>


            <!-- 편성 도움 요청 -->
            <div class="forum-preview-line">
                <h5 class="color-yellow"><i class="fa-solid fa-circle-exclamation"></i> 편성 도움 요청</h5>
                
                <% for(let i=0; i<data.today_ask_form_list.length; i++){ %>
                    <!-- 공유 게시글 하나 -->
                        <%- include('./components/form_preview.ejs', {i: i, data : {
                            from: data.from,
                            form_list : data.today_ask_form_list,
                            members : data.today_ask_members,
                        }}) %> 
                    <!-- 공유 게시글 하나 끝 -->
                <%  }%>
            
            </div>
        </div>
    </div>
    <%- include('footer.ejs') %> 

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script>
        window.onload = function() {

            // console.log("여기는 오나?")
            const urlParams = new URLSearchParams(window.location.search);
            const error = urlParams.get('error');
            if(error == 'needLogin'){
                console.log(error)
                alert("로그인이 필요한 서비스입니다.");
                // history.replaceState(null, "", location.pathname);
                location.href = "/login";
            } else if (error) {
                console.log(error)
                alert(decodeURIComponent(error));
                // history.replaceState(null, "", location.pathname);
                history.go(-1);
            }
        };
    </script>
</body>
</html>